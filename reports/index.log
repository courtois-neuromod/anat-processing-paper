Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# If you're running this notebook in a Jupyter Notebook (eg, on MyBinder), change 'jupyter-book' to 'notebook'
fig_gm.display_paper_fig5('jupyter-book')
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Cell [0;32mIn[8], line 2[0m
[1;32m      1[0m [38;5;66;03m# If you're running this notebook in a Jupyter Notebook (eg, on MyBinder), change 'jupyter-book' to 'notebook'[39;00m
[0;32m----> 2[0m [43mfig_gm[49m[38;5;241;43m.[39;49m[43mdisplay_paper_fig5[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mjupyter-book[39;49m[38;5;124;43m'[39;49m[43m)[49m

File [0;32m~/work/anat-processing-paper/anat-processing-paper/source/analysis/source/tools/plot.py:1460[0m, in [0;36mPlot.display_paper_fig5[0;34m(self, env, fig_id)[0m
[1;32m   1453[0m fig [38;5;241m=[39m make_subplots(
[1;32m   1454[0m     rows[38;5;241m=[39m[38;5;241m3[39m, cols[38;5;241m=[39m[38;5;241m2[39m,
[1;32m   1455[0m     horizontal_spacing [38;5;241m=[39m [38;5;241m0.2[39m, vertical_spacing [38;5;241m=[39m [38;5;241m0.15[39m,
[1;32m   1456[0m     subplot_titles[38;5;241m=[39m([38;5;124m"[39m[38;5;124mT<sub>1</sub> (MTsat)[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mFA (DWI)[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mMTR[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mMD (DWI)[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mMTsat[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mRD (DWI)[39m[38;5;124m"[39m)
[1;32m   1457[0m )
[1;32m   1459[0m [38;5;66;03m# Add datapoints to plot[39;00m
[0;32m-> 1460[0m fig [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43madd_points[49m[43m([49m[43mfig[49m[43m,[49m[43m [49m[43mmatrix[49m[43m,[49m[43m [49m[43mtrace_name[49m[43m,[49m[43m [49m[43mnum_sessions[49m[43m,[49m[43m [49m[43mtissue[49m[43m,[49m[43m [49m[43mfig_id[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mpaper_fig5[39;49m[38;5;124;43m'[39;49m[43m)[49m
[1;32m   1462[0m [38;5;66;03m# Add mean line to plot[39;00m
[1;32m   1463[0m fig, line [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39madd_lines(fig, matrix, trace_name, tissue, fig_id[38;5;241m=[39m[38;5;124m'[39m[38;5;124mpaper_fig5[39m[38;5;124m'[39m)

File [0;32m~/work/anat-processing-paper/anat-processing-paper/source/analysis/source/tools/plot.py:1795[0m, in [0;36mPlot.add_points[0;34m(self, figb, matrix, trace_name, num_sessions, tissue, fig_id)[0m
[1;32m   1793[0m [38;5;28;01mfor[39;00m metric [38;5;129;01min[39;00m trace_name:
[1;32m   1794[0m     [38;5;28;01mif[39;00m [38;5;124m'[39m[38;5;124mT1w[39m[38;5;124m'[39m [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m matrix:
[0;32m-> 1795[0m         [38;5;28;01mfor[39;00m trace [38;5;129;01min[39;00m [38;5;28mrange[39m([38;5;241m0[39m, [38;5;28mlen[39m([43mmatrix[49m[43m[[49m[43mmetric[49m[43m][49m)):
[1;32m   1796[0m             t [38;5;241m=[39m [trace [38;5;241m-[39m[38;5;241m0.3[39m [38;5;241m+[39m i[38;5;241m*[39m(([38;5;241m0.3[39m[38;5;241m*[39m[38;5;241m2[39m)[38;5;241m/[39m(num_sessions[38;5;241m-[39m[38;5;241m1[39m)) [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m [38;5;28mrange[39m([38;5;241m0[39m, num_sessions)]
[1;32m   1798[0m             [38;5;28;01mif[39;00m trace [38;5;241m==[39m [38;5;241m0[39m: 

[0;31mKeyError[0m: 'DWI_FA'
KeyError: 'DWI_FA'

